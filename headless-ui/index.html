<!doctype html>
<html class="not-ready lg:text-base" lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  <!-- Title -->
  <title>
    headless UI 的哲学 - Naeco&#x27;s blog
  </title>

  <!-- Meta -->
  <meta name="theme-color" />

  <!-- Author -->
  
  <meta name="description" content="headless UI 的哲学" />
  <meta name="author" content="headless UI 的哲学" />
  

  <!-- CSS & JS -->
  <link rel="preload stylesheet" as="style" href="https://naecoo.github.io/main.css" />
  <style>
    :root {
      --bg: #f4f4f5;
      --bg-dark: #18181b;
      --header: #e4e4e7;
      --header-dark: #27272a;
    }
  </style>

  

  <!-- Dark Icon -->
  <link rel="preload" as="image" href="https://naecoo.github.io/icons/theme.svg" />

  <!-- Math -->
  
  <!---->

  <!-- Mermaid -->
  
  <!---->
  <script type="module">
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
  mermaid.initialize({ startOnLoad: true });
</script>

  <!---->
  
  <!---->

  <!-- Favicon -->
  <link rel="icon" href="https://naecoo.github.io/favicon.ico" />
  <link rel="apple-touch-icon" href="https://naecoo.github.io/apple-touch-icon.png" />

  <!-- Feeds -->
  
  <!---->
  
  <link
    rel="alternate"
    type="application/atom+xml"
    title="Atom"
    href="https://naecoo.github.io/atom.xml"
  />
  
  <!---->
  

  <!-- Canonical -->
  <link rel="canonical" href="https:&#x2F;&#x2F;naecoo.github.io&#x2F;headless-ui&#x2F;" />
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header
  class="header fixed top-0 z-40 mx-auto min-h-[3.5rem] w-full"
>
  <div class="mx-auto w-full max-w-4xl p-3 lg:flex lg:justify-between">
    <div class="flex justify-between">
      <div class="flex items-center">
        <a class="text-2xl font-semibold" href="https://naecoo.github.io">Naeco&#x27;s blog</a>
        <div
          class="btn-dark ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0] [background:url(./icons/theme.svg)_left_center/cover_no-repeat] dark:invert dark:[background-position:right]"
          role="button"
          aria-label="Dark"
        ></div>
      </div>
      
      <div
        class="btn-menu relative z-50 flex h-8 w-8 shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
        role="button"
        aria-label="Menu"
      ></div>
      
    </div>
    <script>
      // base
      const htmlClass = document.documentElement.classList;
      setTimeout(() => {
        htmlClass.remove("not-ready");
      }, 10);

      // mobile menu
      const btnMenu = document.querySelector(".btn-menu");
      btnMenu?.addEventListener("click", () => {
        htmlClass.toggle("open");
      });

      // dark theme
      const setDark = (isDark) => {
        htmlClass[isDark ? "add" : "remove"]("dark");
        localStorage.setItem("dark", isDark);
      };

      // init
      const darkScheme = window.matchMedia("(prefers-color-scheme: dark)");
      if (htmlClass.contains("dark")) {
        setDark(true);
      } else {
        const darkVal = localStorage.getItem("dark");
        setDark(darkVal ? darkVal === "true" : darkScheme.matches);
      }

      // listen system
      darkScheme.addEventListener("change", (event) => {
        setDark(event.matches);
      });

      // manual switch
      const btnDark = document.querySelector(".btn-dark");
      btnDark.addEventListener("click", () => {
        setDark(localStorage.getItem("dark") !== "true");
      });
    </script>
    
    <nav class="flex w-full items-center lg:w-auto">
      <ul
        class="nav-wrapper flex w-full flex-col py-2 lg:w-auto lg:flex-row lg:self-center lg:py-0"
      >
        
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://naecoo.github.io/archive"
            >Archive</a
          >
        </li>
        
        <li>
          <a
            class="primary-link block py-2 text-center text-lg font-medium lg:px-3 lg:py-0"
            href="https://naecoo.github.io/tags"
            >Tags</a
          >
        </li>
        
      </ul>
    </nav>
    
  </div>
</header>


    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-4 pb-16 pt-32 dark:prose-invert"
    >
      
<article>
  <header class="mb-16">
    <h1 class="!my-0 pb-2.5">headless UI 的哲学</h1>
    <div class="text-sm antialiased opacity-60">
  
  <time>2022-12-31</time>
  <span class="mx-1">&middot;</span>
  <span>10min</span>
  <!---->
  
  <!---->
  
  <span class="mx-1">&middot;</span>
  <span>naeco</span>
  
</div>

  </header>

  

  <!-- TOC -->
  <!---->
<div class="block-bg mb-12 flex rounded-lg p-2 text-lg">
  <details>
    <summary class="cursor-pointer py-1 pl-4">
      <span>Table of Contents</span>
    </summary>
    <div class="px-2">
      <ul>
        
        <li>
          <a class="no-underline hover:underline" href="https://naecoo.github.io/headless-ui/#shen-me-shi-headless-ui"
            >什么是 headless UI</a
          >
          
        </li>
        
        <li>
          <a class="no-underline hover:underline" href="https://naecoo.github.io/headless-ui/#wei-shen-me-yao-yong-headless-ui"
            >为什么要用 headless UI</a
          >
          
        </li>
        
        <li>
          <a class="no-underline hover:underline" href="https://naecoo.github.io/headless-ui/#headless-ui-shi-jian"
            >headless UI 实践</a
          >
          
        </li>
        
        <li>
          <a class="no-underline hover:underline" href="https://naecoo.github.io/headless-ui/#zong-jie"
            >总结</a
          >
          
        </li>
        
      </ul>
    </div>
  </details>
</div>

<!---->

  <!-- Content -->
  <section><h3 id="shen-me-shi-headless-ui">什么是 headless UI</h3>
<p>headless 直译过来就是无头的，比方说 headless browser，指的是无头浏览器。无头浏览器也是浏览器，不过缺少了图形界面，通常用编程来控制这种浏览器，用于测试等任务。headless UI 也是差不多的意思，指的就是<strong>不提供样式的 UI 组件</strong>。相对于传统的 UI 组件，比方说 antd、element-ui 等的传统组件库，headless UI 组件只处理状态变更、事件绑定、浏览器兼容性和无障碍访问等功能，唯独就是缺少了样式。</p>
<p>我们来看一些简单的例子，一般的 UI 组件库，我们一般这样使用组件：</p>
<pre data-lang="typescript" style="background-color:#2b303b;color:#c0c5ce;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span>&lt;</span><span style="color:#bf616a;">script setup lang</span><span>=&quot;</span><span style="color:#a3be8c;">ts</span><span>&quot;&gt;
</span><span style="color:#b48ead;">import </span><span>{ </span><span style="color:#bf616a;">ref </span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">vue</span><span>&#39;
</span><span>
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">enabled </span><span>= </span><span style="color:#8fa1b3;">ref</span><span>(</span><span style="color:#d08770;">false</span><span>)
</span><span>&lt;/</span><span style="color:#bf616a;">script</span><span>&gt;
</span><span>
</span><span>&lt;template&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">el</span><span>-</span><span style="color:#b48ead;">switch </span><span style="color:#bf616a;">v</span><span>-</span><span style="color:#bf616a;">model</span><span>=&quot;</span><span style="color:#a3be8c;">enabled</span><span>&quot;&gt;&lt;/el-switch&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">template</span><span>&gt;
</span></code></pre>
<p>当使用 headless UI 组件时，我们需要这样写代码：</p>
<blockquote>
<p>本文使用了 TailwindCSS 作为样式解决方案</p>
</blockquote>
<pre data-lang="typescript" style="background-color:#2b303b;color:#c0c5ce;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span>&lt;</span><span style="color:#bf616a;">script setup lang</span><span>=&quot;</span><span style="color:#a3be8c;">ts</span><span>&quot;&gt;
</span><span style="color:#b48ead;">import </span><span>{ </span><span style="color:#bf616a;">ref </span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">vue</span><span>&#39;
</span><span style="color:#b48ead;">import </span><span>{ </span><span style="color:#bf616a;">Switch </span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">@headlessui/vue</span><span>&#39;
</span><span>
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">enabled </span><span>= </span><span style="color:#8fa1b3;">ref</span><span>(</span><span style="color:#d08770;">false</span><span>)
</span><span>&lt;/</span><span style="color:#bf616a;">script</span><span>&gt;
</span><span>
</span><span>&lt;template&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">div class</span><span>=&quot;</span><span style="color:#a3be8c;">py-16</span><span>&quot;&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">Switch v</span><span>-</span><span style="color:#bf616a;">model</span><span>=&quot;</span><span style="color:#a3be8c;">enabled</span><span>&quot; :</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">enabled ? &#39;bg-teal-900&#39; : &#39;bg-teal-700&#39;</span><span>&quot;
</span><span>      </span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">relative inline-flex h-[38px] w-[74px] shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75</span><span>&quot;&gt;
</span><span>      &lt;</span><span style="color:#bf616a;">span class</span><span>=&quot;</span><span style="color:#a3be8c;">sr-only</span><span>&quot;&gt;</span><span style="color:#bf616a;">Use setting</span><span>&lt;/</span><span style="color:#bf616a;">span</span><span>&gt;
</span><span>      &lt;</span><span style="color:#bf616a;">span aria</span><span>-</span><span style="color:#bf616a;">hidden</span><span>=&quot;</span><span style="color:#a3be8c;">true</span><span>&quot; :</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">enabled ? &#39;translate-x-9&#39; : &#39;translate-x-0&#39;</span><span>&quot;
</span><span>        </span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">pointer-events-none inline-block h-[34px] w-[34px] transform rounded-full bg-white shadow-lg ring-0 transition duration-200 ease-in-out</span><span>&quot; /&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">Switch</span><span>&gt;
</span><span>  &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">template</span><span>&gt;
</span></code></pre>
<p>很明显可以看出区别了，headless UI 组件需要我们自己处理样式。</p>
<blockquote>
<p>一般情况下，我们也不会直接使用 Headless UI 组件，会包装一层样式再使用</p>
</blockquote>
<h3 id="wei-shen-me-yao-yong-headless-ui">为什么要用 headless UI</h3>
<p>相较于传统的组件，headless UI 组件还需要进一步地封装，稍嫌麻烦。那为什么我们要使用它呢？这里我们可以从传统地组件库开始分析，一般的组件库虽然方便，开箱即用，但是在真实业务场景中灵活性远远不足，体现在：</p>
<ol>
<li>每个公司可能都有自己的设计系统，组件库基本上只能做一些主题色的定制，更深层次的定制就捉襟见肘了，所以与公司设计系统不一致，造成体验上的割裂感</li>
<li>不同的业务场景有不同的需求，通用的组件库是无法胜任灵活的业务系统。而且做定制化需要对组件库内部细节有一定的了解，代码会严重耦合，难于维护和扩展。关于这点，相信做过表单和表格组件定制化的同学记忆深刻...</li>
</ol>
<p>headless UI 的出现解决了这两个问题，你不是要定制样式吗，现在我连样式都不提供，全部由你自己来实现，想怎么折腾就怎么折腾，无论多离谱的定制化都能实现。headless UI 核心是逻辑和样式分离，只提供最核心的逻辑，当你觉得功能不够丰富，不能满足业务需求时，你可以在 headless UI 组件的基础上自由发挥，组合不同的技术，实现你想要的效果。在 headless UI 组件的基础上，你可以使用各种样式解决方案：TailwindCSS、CSS modules、CSS in JS ... ；各种的状态存储方案：响应式数据、不可变数据 ...</p>
<p>举一个很简单的例子，我们有一个表格组件，由于数据量太大，我们要在表格上实现虚拟滚动的效果。对于传统的组件，这几乎是不可能实现的需求，因为渲染逻辑是表格内部控制的，业务层是无法控制的。就算能实现，也会影响到其它功能，比如勾选、筛选、分列等等。如果使用 headless UI 来实现，业务层可以完全控制渲染逻辑，不需要修改表格内部的逻辑，只需要在此基础上再套上一个 headless 虚拟滚动组件。</p>
<p>伪代码如下：</p>
<pre data-lang="typescript" style="background-color:#2b303b;color:#c0c5ce;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span>&lt;</span><span style="color:#bf616a;">script setup lang</span><span>=&quot;</span><span style="color:#a3be8c;">ts</span><span>&quot;&gt;
</span><span style="color:#b48ead;">import </span><span>{ </span><span style="color:#bf616a;">ref </span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">vue</span><span>&#39;
</span><span>
</span><span style="color:#65737e;">// 全部表格数据
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">list </span><span>= </span><span style="color:#8fa1b3;">ref</span><span>([
</span><span>    {
</span><span>        id: </span><span style="color:#d08770;">1</span><span>,
</span><span>        name: &#39;</span><span style="color:#a3be8c;">foo</span><span>&#39;
</span><span>    },
</span><span>    {
</span><span>        id: </span><span style="color:#d08770;">2</span><span>,
</span><span>        name: &#39;</span><span style="color:#a3be8c;">bar</span><span>&#39;
</span><span>    }
</span><span>]);
</span><span style="color:#65737e;">// 当前要渲染的数据
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">renderList </span><span>= </span><span style="color:#8fa1b3;">ref</span><span>([]);
</span><span>
</span><span style="color:#65737e;">// 更新渲染数据
</span><span style="color:#b48ead;">const </span><span style="color:#8fa1b3;">onScroll </span><span>= (</span><span style="color:#bf616a;">data</span><span>) </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#bf616a;">renderList</span><span>.value = </span><span style="color:#bf616a;">data</span><span>;
</span><span>};
</span><span>&lt;/</span><span style="color:#bf616a;">script</span><span>&gt;
</span><span>
</span><span>&lt;template&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">headless</span><span>-table :</span><span style="color:#bf616a;">data</span><span>=&quot;</span><span style="color:#a3be8c;">list</span><span>&quot;&gt;
</span><span> 	&lt;</span><span style="color:#bf616a;">div class</span><span>=&quot;</span><span style="color:#a3be8c;">scroll-container</span><span>&quot;&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">headless</span><span>-</span><span style="color:#bf616a;">vitrual</span><span>-</span><span style="color:#bf616a;">scroll height</span><span>=&quot;</span><span style="color:#a3be8c;">20</span><span>&quot; </span><span style="color:#bf616a;">size</span><span>=&quot;</span><span style="color:#a3be8c;">20</span><span>&quot; :</span><span style="color:#bf616a;">data</span><span>=&quot;</span><span style="color:#a3be8c;">list</span><span>&quot; @</span><span style="color:#bf616a;">change</span><span>=&quot;</span><span style="color:#a3be8c;">onScroll</span><span>&quot;&gt;
</span><span>            &lt;</span><span style="color:#bf616a;">div v</span><span>-</span><span style="color:#bf616a;">for</span><span>=&quot;</span><span style="color:#a3be8c;">item in renderList</span><span>&quot; :</span><span style="color:#bf616a;">key</span><span>=&quot;</span><span style="color:#a3be8c;">item.id</span><span>&quot;&gt;
</span><span>            	</span><span style="color:#65737e;">// 渲染每一行...
</span><span>            &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">headless</span><span>-</span><span style="color:#bf616a;">vitrual</span><span>-</span><span style="color:#bf616a;">scroll</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>  &lt;/</span><span style="color:#bf616a;">headless</span><span>-</span><span style="color:#bf616a;">table</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">template</span><span>&gt;
</span></code></pre>
<h3 id="headless-ui-shi-jian">headless UI 实践</h3>
<p>接下来，我们做一些实践，基于 headless UI 组件实现一个完善的 Select 组件</p>
<p>基本的代码：</p>
<pre data-lang="typescript" style="background-color:#2b303b;color:#c0c5ce;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span>&lt;</span><span style="color:#bf616a;">script setup lang</span><span>=&quot;</span><span style="color:#a3be8c;">ts</span><span>&quot;&gt;
</span><span style="color:#b48ead;">import </span><span>{ </span><span style="color:#bf616a;">ref </span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">vue</span><span>&#39;
</span><span style="color:#b48ead;">import </span><span>{
</span><span>  </span><span style="color:#bf616a;">Listbox</span><span>,
</span><span>  </span><span style="color:#bf616a;">ListboxButton</span><span>,
</span><span>  </span><span style="color:#bf616a;">ListboxOptions</span><span>,
</span><span>  </span><span style="color:#bf616a;">ListboxOption</span><span>,
</span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">@headlessui/vue</span><span>&#39;
</span><span>
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">fruits </span><span>= [
</span><span>  { id: </span><span style="color:#d08770;">1</span><span>, name: &#39;</span><span style="color:#a3be8c;">苹果</span><span>&#39; },
</span><span>  { id: </span><span style="color:#d08770;">2</span><span>, name: &#39;</span><span style="color:#a3be8c;">香蕉</span><span>&#39; },
</span><span>  { id: </span><span style="color:#d08770;">3</span><span>, name: &#39;</span><span style="color:#a3be8c;">草莓</span><span>&#39; },
</span><span>  { id: </span><span style="color:#d08770;">4</span><span>, name: &#39;</span><span style="color:#a3be8c;">西瓜</span><span>&#39; },
</span><span>  { id: </span><span style="color:#d08770;">5</span><span>, name: &#39;</span><span style="color:#a3be8c;">橘子</span><span>&#39; },
</span><span>]
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">selectedFruit </span><span>= </span><span style="color:#8fa1b3;">ref</span><span>(</span><span style="color:#bf616a;">fruits</span><span>[</span><span style="color:#d08770;">0</span><span>])
</span><span>&lt;/</span><span style="color:#bf616a;">script</span><span>&gt;
</span><span>
</span><span>&lt;template&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">Listbox v</span><span>-</span><span style="color:#bf616a;">model</span><span>=&quot;</span><span style="color:#a3be8c;">selectedFruit</span><span>&quot;&gt;
</span><span>    &lt;ListboxButton&gt;{{ selectedFruit.</span><span style="color:#bf616a;">name </span><span>}}&lt;/</span><span style="color:#bf616a;">ListboxButton</span><span>&gt;
</span><span>    &lt;ListboxOptions&gt;
</span><span>      &lt;</span><span style="color:#bf616a;">ListboxOption v</span><span>-</span><span style="color:#bf616a;">for</span><span>=&quot;</span><span style="color:#a3be8c;">fruit in fruits</span><span>&quot; :</span><span style="color:#bf616a;">key</span><span>=&quot;</span><span style="color:#a3be8c;">fruit.id</span><span>&quot; :</span><span style="color:#bf616a;">value</span><span>=&quot;</span><span style="color:#a3be8c;">fruit</span><span>&quot;&gt;
</span><span>        {{ </span><span style="color:#bf616a;">fruit</span><span>.name }}
</span><span>      &lt;/</span><span style="color:#bf616a;">ListboxOption</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">ListboxOptions</span><span>&gt;
</span><span>  &lt;/</span><span style="color:#bf616a;">Listbox</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">template</span><span>&gt;
</span></code></pre>
<p>代码很简单，就是渲染选中的值和选项，没有任何 UI，效果如下：</p>
<p><img src="https://naecoo.github.io/headless-ui/./1672402694198.gif" alt="1" /></p>
<p>加一点样式：</p>
<pre data-lang="typescript" style="background-color:#2b303b;color:#c0c5ce;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span>&lt;template&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">Listbox v</span><span>-</span><span style="color:#bf616a;">model</span><span>=&quot;</span><span style="color:#a3be8c;">selectedFruit</span><span>&quot;&gt;
</span><span>    &lt;ListboxButton&gt;{{ selectedFruit.</span><span style="color:#bf616a;">name </span><span>}}&lt;/</span><span style="color:#bf616a;">ListboxButton</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">ListboxOptions class</span><span>=&quot;</span><span style="color:#a3be8c;">w-32 border border-solid border-zinc-400</span><span>&quot;&gt;
</span><span>      &lt;</span><span style="color:#bf616a;">ListboxOption v</span><span>-</span><span style="color:#bf616a;">slot</span><span>=&quot;</span><span style="color:#a3be8c;">{ active, selected }</span><span>&quot; </span><span style="color:#bf616a;">v</span><span>-</span><span style="color:#bf616a;">for</span><span>=&quot;</span><span style="color:#a3be8c;">fruit in fruits</span><span>&quot; :</span><span style="color:#bf616a;">key</span><span>=&quot;</span><span style="color:#a3be8c;">fruit.id</span><span>&quot; :</span><span style="color:#bf616a;">value</span><span>=&quot;</span><span style="color:#a3be8c;">person</span><span>&quot;&gt;
</span><span>        &lt;li :</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="background-color:#bf616a;color:#2b303b;">[</span><span>
</span><span>          </span><span style="color:#bf616a;">active </span><span>? &#39;</span><span style="color:#a3be8c;">bg-amber-100 text-amber-900</span><span>&#39; : &#39;</span><span style="color:#a3be8c;">text-gray-900</span><span>&#39;,
</span><span>          &#39;</span><span style="color:#a3be8c;">relative cursor-default select-none py-2 pl-10 pr-4</span><span>&#39;,
</span><span>        ]&quot;</span><span style="background-color:#bf616a;color:#2b303b;">&gt;</span><span>
</span><span>          &lt;span :</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="background-color:#bf616a;color:#2b303b;">[</span><span>
</span><span>            </span><span style="color:#bf616a;">selected </span><span>? &#39;</span><span style="color:#a3be8c;">font-medium</span><span>&#39; : &#39;</span><span style="color:#a3be8c;">font-normal</span><span>&#39;,
</span><span>            &#39;</span><span style="color:#a3be8c;">block truncate cursor-pointer</span><span>&#39;,
</span><span>          ]&quot;</span><span style="color:#a3be8c;">&gt;{{ fruit.name }}&lt;/span</span><span style="background-color:#bf616a;color:#2b303b;">&gt;</span><span>
</span><span>        &lt;/</span><span style="color:#bf616a;">li</span><span>&gt;
</span><span>      &lt;/</span><span style="color:#bf616a;">ListboxOption</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">ListboxOptions</span><span>&gt;
</span><span>  &lt;/</span><span style="color:#bf616a;">Listbox</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">template</span><span>&gt;
</span></code></pre>
<p><img src="https://naecoo.github.io/headless-ui/./1672458107108.gif" alt="2" /></p>
<p>加上多选和禁用选项的功能：</p>
<pre data-lang="typescript" style="background-color:#2b303b;color:#c0c5ce;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span>&lt;script&gt;
</span><span>...
</span><span>
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">fruits </span><span>= [
</span><span>  { id: </span><span style="color:#d08770;">1</span><span>, name: &#39;</span><span style="color:#a3be8c;">苹果</span><span>&#39;, disabled: </span><span style="color:#d08770;">false</span><span>, },
</span><span>  { id: </span><span style="color:#d08770;">2</span><span>, name: &#39;</span><span style="color:#a3be8c;">香蕉</span><span>&#39;, disabled: </span><span style="color:#d08770;">false</span><span>, },
</span><span>  { id: </span><span style="color:#d08770;">3</span><span>, name: &#39;</span><span style="color:#a3be8c;">草莓</span><span>&#39;, disabled: </span><span style="color:#d08770;">true</span><span>, },
</span><span>  { id: </span><span style="color:#d08770;">4</span><span>, name: &#39;</span><span style="color:#a3be8c;">西瓜</span><span>&#39;, disabled: </span><span style="color:#d08770;">false</span><span>, },
</span><span>  { id: </span><span style="color:#d08770;">5</span><span>, name: &#39;</span><span style="color:#a3be8c;">橘子</span><span>&#39;, disabled: </span><span style="color:#d08770;">true</span><span>, },
</span><span>]
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">selectedFruits </span><span>= </span><span style="color:#8fa1b3;">ref</span><span>([</span><span style="color:#bf616a;">fruits</span><span>[</span><span style="color:#d08770;">0</span><span>], </span><span style="color:#bf616a;">fruits</span><span>[</span><span style="color:#d08770;">1</span><span>]]);
</span><span>&lt;/</span><span style="color:#bf616a;">scripts</span><span>&gt;
</span><span>
</span><span>&lt;template&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">Listbox multiple v</span><span>-</span><span style="color:#bf616a;">model</span><span>=&quot;</span><span style="color:#a3be8c;">selectedFruits</span><span>&quot;&gt;
</span><span>    &lt;ListboxButton&gt;
</span><span>      selected: {{ </span><span style="color:#bf616a;">selectedFruits</span><span>.</span><span style="color:#8fa1b3;">map</span><span>(</span><span style="color:#bf616a;">fruit </span><span style="color:#b48ead;">=&gt; </span><span style="color:#bf616a;">fruit</span><span>.name).</span><span style="color:#96b5b4;">join</span><span>(&#39;</span><span style="color:#a3be8c;">, </span><span>&#39;) }}
</span><span>    &lt;/</span><span style="color:#bf616a;">ListboxButton</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">ListboxOptions class</span><span>=&quot;</span><span style="color:#a3be8c;">w-32 border border-solid border-zinc-400</span><span>&quot;&gt;
</span><span>      &lt;</span><span style="color:#bf616a;">ListboxOption v</span><span>-</span><span style="color:#bf616a;">slot</span><span>=&quot;</span><span style="color:#a3be8c;">{ active, selected }</span><span>&quot; </span><span style="color:#bf616a;">v</span><span>-</span><span style="color:#bf616a;">for</span><span>=&quot;</span><span style="color:#a3be8c;">fruit in fruits</span><span>&quot; :</span><span style="color:#bf616a;">key</span><span>=&quot;</span><span style="color:#a3be8c;">fruit.id</span><span>&quot; :</span><span style="color:#bf616a;">value</span><span>=&quot;</span><span style="color:#a3be8c;">fruit</span><span>&quot;
</span><span>        :</span><span style="color:#bf616a;">disabled</span><span>=&quot;</span><span style="color:#a3be8c;">fruit.disabled</span><span>&quot;&gt;
</span><span>        &lt;li :</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="background-color:#bf616a;color:#2b303b;">[</span><span>
</span><span>          </span><span style="color:#bf616a;">active </span><span>? &#39;</span><span style="color:#a3be8c;">bg-amber-100 text-amber-900</span><span>&#39; : &#39;</span><span style="color:#a3be8c;">text-gray-900</span><span>&#39;,
</span><span>          &#39;</span><span style="color:#a3be8c;">relative cursor-default select-none py-2 pl-10 pr-4</span><span>&#39;,
</span><span>        ]&quot;</span><span style="background-color:#bf616a;color:#2b303b;">&gt;</span><span>
</span><span>          &lt;span :</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="background-color:#bf616a;color:#2b303b;">[</span><span>
</span><span>            </span><span style="color:#bf616a;">selected </span><span>? &#39;</span><span style="color:#a3be8c;">font-medium text-red-500</span><span>&#39; : &#39;</span><span style="color:#a3be8c;">font-normal</span><span>&#39;,
</span><span>            </span><span style="color:#bf616a;">fruit</span><span>.disabled ? &#39;</span><span style="color:#a3be8c;">opacity-30 cursor-not-allowed</span><span>&#39; : &#39;</span><span style="color:#a3be8c;">cursor-pointer</span><span>&#39;,
</span><span>            &#39;</span><span style="color:#a3be8c;">block truncate</span><span>&#39;,
</span><span>          ]&quot;</span><span style="color:#a3be8c;">&gt;{{ fruit.name }}&lt;/span</span><span style="background-color:#bf616a;color:#2b303b;">&gt;</span><span>
</span><span>        &lt;/</span><span style="color:#bf616a;">li</span><span>&gt;
</span><span>      &lt;/</span><span style="color:#bf616a;">ListboxOption</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">ListboxOptions</span><span>&gt;
</span><span>  &lt;/</span><span style="color:#bf616a;">Listbox</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">template</span><span>&gt;
</span></code></pre>
<p><img src="https://naecoo.github.io/headless-ui/./1672930940904.gif" alt="3" /></p>
<p>最后完善一下样式，一个基本的 Select 组件就诞生了：</p>
<pre data-lang="typescript" style="background-color:#2b303b;color:#c0c5ce;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span>&lt;</span><span style="color:#bf616a;">script setup lang</span><span>=&quot;</span><span style="color:#a3be8c;">ts</span><span>&quot;&gt;
</span><span style="color:#b48ead;">import </span><span>{ </span><span style="color:#bf616a;">ref </span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">vue</span><span>&#39;
</span><span style="color:#b48ead;">import </span><span>{
</span><span>  </span><span style="color:#bf616a;">Listbox</span><span>,
</span><span>  </span><span style="color:#bf616a;">ListboxButton</span><span>,
</span><span>  </span><span style="color:#bf616a;">ListboxOptions</span><span>,
</span><span>  </span><span style="color:#bf616a;">ListboxOption</span><span>,
</span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">@headlessui/vue</span><span>&#39;
</span><span style="color:#b48ead;">import </span><span>{ </span><span style="color:#bf616a;">CheckIcon</span><span>, </span><span style="color:#bf616a;">ChevronUpDownIcon </span><span>} </span><span style="color:#b48ead;">from </span><span>&#39;</span><span style="color:#a3be8c;">@heroicons/vue/20/solid</span><span>&#39;
</span><span>
</span><span style="color:#b48ead;">interface </span><span>Fruit {
</span><span>  </span><span style="color:#bf616a;">id</span><span>: number;
</span><span>  </span><span style="color:#bf616a;">name</span><span>: string;
</span><span>  </span><span style="color:#bf616a;">disabled</span><span>: boolean;
</span><span>}
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">fruits</span><span>: Fruit[] = [
</span><span>  { id: </span><span style="color:#d08770;">1</span><span>, name: &#39;</span><span style="color:#a3be8c;">苹果</span><span>&#39;, disabled: </span><span style="color:#d08770;">false</span><span>, },
</span><span>  { id: </span><span style="color:#d08770;">2</span><span>, name: &#39;</span><span style="color:#a3be8c;">香蕉</span><span>&#39;, disabled: </span><span style="color:#d08770;">false</span><span>, },
</span><span>  { id: </span><span style="color:#d08770;">3</span><span>, name: &#39;</span><span style="color:#a3be8c;">草莓</span><span>&#39;, disabled: </span><span style="color:#d08770;">true</span><span>, },
</span><span>  { id: </span><span style="color:#d08770;">4</span><span>, name: &#39;</span><span style="color:#a3be8c;">西瓜</span><span>&#39;, disabled: </span><span style="color:#d08770;">false</span><span>, },
</span><span>  { id: </span><span style="color:#d08770;">5</span><span>, name: &#39;</span><span style="color:#a3be8c;">橘子</span><span>&#39;, disabled: </span><span style="color:#d08770;">false</span><span>, },
</span><span>]
</span><span>
</span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">selectedFruits </span><span>= </span><span style="color:#8fa1b3;">ref</span><span>&lt;Fruit[]&gt;([]);
</span><span>&lt;/</span><span style="color:#bf616a;">script</span><span>&gt;
</span><span>
</span><span>&lt;template&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">div class</span><span>=&quot;</span><span style="color:#a3be8c;">fixed top-16 w-72 pl-20</span><span>&quot;&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">Listbox multiple v</span><span>-</span><span style="color:#bf616a;">model</span><span>=&quot;</span><span style="color:#a3be8c;">selectedFruits</span><span>&quot;&gt;
</span><span>      &lt;</span><span style="color:#bf616a;">div class</span><span>=&quot;</span><span style="color:#a3be8c;">relative mt-1</span><span>&quot;&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">ListboxButton
</span><span>          </span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">relative w-full cursor-default rounded-lg bg-white h-10 py-2 pl-3 pr-10 text-left shadow-md focus:outline-none focus-visible:border-indigo-500 focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 focus-visible:ring-offset-2 focus-visible:ring-offset-orange-300 sm:text-sm</span><span>&quot;
</span><span>        &gt;
</span><span>          &lt;</span><span style="color:#bf616a;">span class</span><span>=&quot;</span><span style="color:#a3be8c;">block truncate</span><span>&quot;&gt;{{ selectedFruits.map(</span><span style="color:#bf616a;">fruit </span><span style="color:#b48ead;">=&gt; </span><span style="color:#bf616a;">fruit</span><span>.name).</span><span style="color:#96b5b4;">join</span><span>(&#39;</span><span style="color:#a3be8c;">, </span><span>&#39;) }}&lt;/</span><span style="color:#bf616a;">span</span><span>&gt;
</span><span>          &lt;</span><span style="color:#bf616a;">span class</span><span>=&quot;</span><span style="color:#a3be8c;">pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2</span><span>&quot;&gt;
</span><span>            &lt;</span><span style="color:#bf616a;">ChevronUpDownIcon class</span><span>=&quot;</span><span style="color:#a3be8c;">h-5 w-5 text-gray-400</span><span>&quot; </span><span style="color:#bf616a;">aria</span><span>-</span><span style="color:#bf616a;">hidden</span><span>=&quot;</span><span style="color:#a3be8c;">true</span><span>&quot; /&gt;
</span><span>          &lt;/</span><span style="color:#bf616a;">span</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">ListboxButton</span><span>&gt;
</span><span>
</span><span>        &lt;</span><span style="color:#bf616a;">transition
</span><span>          </span><span style="color:#bf616a;">leave</span><span>-</span><span style="color:#bf616a;">active</span><span>-</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">transition duration-100 ease-in</span><span>&quot;
</span><span>          </span><span style="color:#bf616a;">leave</span><span>-</span><span style="color:#bf616a;">from</span><span>-</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">opacity-100</span><span>&quot;
</span><span>          </span><span style="color:#bf616a;">leave</span><span>-</span><span style="color:#bf616a;">to</span><span>-</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">opacity-0</span><span>&quot;
</span><span>        &gt;
</span><span>          &lt;</span><span style="color:#bf616a;">ListboxOptions
</span><span>            </span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">absolute mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm</span><span>&quot;
</span><span>          &gt;
</span><span>            &lt;</span><span style="color:#bf616a;">ListboxOption
</span><span>              </span><span style="color:#bf616a;">v</span><span>-</span><span style="color:#bf616a;">slot</span><span>=&quot;</span><span style="color:#a3be8c;">{ active, selected }</span><span>&quot;
</span><span>              </span><span style="color:#bf616a;">v</span><span>-</span><span style="color:#bf616a;">for</span><span>=&quot;</span><span style="color:#a3be8c;">fruit in fruits</span><span>&quot;
</span><span>              :</span><span style="color:#bf616a;">key</span><span>=&quot;</span><span style="color:#a3be8c;">fruit.id</span><span>&quot;
</span><span>              :</span><span style="color:#bf616a;">value</span><span>=&quot;</span><span style="color:#a3be8c;">fruit</span><span>&quot;
</span><span>              :</span><span style="color:#bf616a;">disabled</span><span>=&quot;</span><span style="color:#a3be8c;">fruit.disabled</span><span>&quot;
</span><span>              </span><span style="color:#bf616a;">as</span><span>=&quot;</span><span style="color:#a3be8c;">template</span><span>&quot;
</span><span>            &gt;
</span><span>              &lt;</span><span style="color:#bf616a;">li
</span><span>                :</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="background-color:#bf616a;color:#2b303b;">[</span><span>
</span><span>                  </span><span style="color:#bf616a;">active </span><span>? &#39;</span><span style="color:#a3be8c;">bg-amber-100 text-amber-900</span><span>&#39; : &#39;</span><span style="color:#a3be8c;">text-gray-900</span><span>&#39;,
</span><span>                  &#39;</span><span style="color:#a3be8c;">relative cursor-default select-none py-2 pl-10 pr-4</span><span>&#39;,
</span><span>                ]&quot;
</span><span style="color:#a3be8c;">              </span><span style="background-color:#bf616a;color:#2b303b;">&gt;</span><span>
</span><span>                &lt;</span><span style="color:#bf616a;">span
</span><span>                  :</span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="background-color:#bf616a;color:#2b303b;">[</span><span>
</span><span>                    </span><span style="color:#bf616a;">selected </span><span>? &#39;</span><span style="color:#a3be8c;">font-medium</span><span>&#39; : &#39;</span><span style="color:#a3be8c;">font-normal</span><span>&#39;,
</span><span>                    </span><span style="color:#bf616a;">fruit</span><span>.disabled ? &#39;</span><span style="color:#a3be8c;">opacity-30 cursor-not-allowed</span><span>&#39; : &#39;</span><span style="color:#a3be8c;">cursor-pointer</span><span>&#39;,
</span><span>                    &#39;</span><span style="color:#a3be8c;">block truncate</span><span>&#39;,
</span><span>                  ]&quot;
</span><span style="color:#a3be8c;">                </span><span style="background-color:#bf616a;color:#2b303b;">&gt;</span><span>
</span><span>                  {{ </span><span style="color:#bf616a;">fruit</span><span>.name }}
</span><span>                &lt;/</span><span style="color:#bf616a;">span</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">span v</span><span>-</span><span style="color:#b48ead;">if</span><span>=&quot;</span><span style="color:#a3be8c;">selected</span><span>&quot; </span><span style="color:#bf616a;">class</span><span>=&quot;</span><span style="color:#a3be8c;">absolute inset-y-0 left-0 flex items-center pl-3 text-amber-600</span><span>&quot;&gt;
</span><span>                  &lt;</span><span style="color:#bf616a;">CheckIcon class</span><span>=&quot;</span><span style="color:#a3be8c;">h-5 w-5</span><span>&quot; </span><span style="color:#bf616a;">aria</span><span>-</span><span style="color:#bf616a;">hidden</span><span>=&quot;</span><span style="color:#a3be8c;">true</span><span>&quot; /&gt;
</span><span>                &lt;/</span><span style="color:#bf616a;">span</span><span>&gt;
</span><span>              &lt;/</span><span style="color:#bf616a;">li</span><span>&gt;
</span><span>            &lt;/</span><span style="color:#bf616a;">ListboxOption</span><span>&gt;
</span><span>          &lt;/</span><span style="color:#bf616a;">ListboxOptions</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">transition</span><span>&gt;
</span><span>      &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">Listbox</span><span>&gt;
</span><span>  &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">template</span><span>&gt;
</span></code></pre>
<blockquote>
<p>录制出来的 GIF 图片显示有一点问题</p>
</blockquote>
<p><img src="https://naecoo.github.io/headless-ui/./1673180245693.gif" alt="5" /></p>
<h3 id="zong-jie">总结</h3>
<p>本文介绍了 headless UI 的一些概念，从传统 UI 库的痛点出发，介绍了 headless UI 的优势，如何解决这些痛点。最后，基于实际的业务场景，学习了如何使用 headless UI 组件。</p>
<p>软件工程没有银弹，headless UI 的解决一部分问题的同时，也会引入新的问题，比如，提高了编码的复杂性。headless UI 组件并不像一般的组件那样开箱即用，需要开发者做大量的封装，才能真正在业务上使用，对于开发者的能力有较高的要求。</p>
</section>

  <hr />

  <!-- Post Taxonomies -->
  
<footer class="mt-12 flex flex-col">
  <!---->
  <!---->
  <!---->
  <!---->
  
  <div class="mb-2 flex flex-wrap">
    <span class="block-bg mb-1.5 mr-1.5 rounded-lg px-5 py-1.5">Tags </span>
    
    <a
      class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline"
      href="https://naecoo.github.io/tags/javascript/"
      >javascript</a
    >
    
    <a
      class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline"
      href="https://naecoo.github.io/tags/vue/"
      >vue</a
    >
    
  </div>
  
</footer>

<!---->

  <!-- Post Nav -->
  
<nav class="block-bg mt-12 flex rounded-lg text-lg">
  
  <a
    class="block-hover-mask flex w-1/2 items-center rounded-l-md p-6 pr-3 font-semibold no-underline"
    href="https:&#x2F;&#x2F;naecoo.github.io&#x2F;life-is-not-short&#x2F;"
    ><span class="mr-1.5">←</span><span>人生并不短暂</span></a
  >
  <!---->
  
  <a
    class="block-hover-mask ml-auto flex w-1/2 items-center justify-end rounded-r-md p-6 pl-3 font-semibold no-underline"
    href="https:&#x2F;&#x2F;naecoo.github.io&#x2F;dayjs&#x2F;"
    ><span>dayjs 分析</span><span class="ml-1.5">→</span></a
  >
  
</nav>

<!---->

  <!-- Comment -->
  
</article>

    </main>

    <footer class="mx-auto flex max-w-3xl flex-wrap items-center px-8 py-4 text-sm opacity-60">
  <div class="mr-auto basis-full lg:basis-1/2">
    &copy;  2024
    <a class="link" href="https://naecoo.github.io"
      >naeco</a
    >
    
  </div>
  <div class="flex basis-full lg:basis-1/2 lg:justify-end">
    <a class="link mr-6 lg:ml-6" href="https://www.getzola.org/" rel="noopener" target="_blank"
      >Powered by Zola</a
    >
    <a class="link" href="https://github.com/st1020/kita" rel="noopener" target="_blank">✎ Kita</a>
  </div>
</footer>

  </body>
</html>
